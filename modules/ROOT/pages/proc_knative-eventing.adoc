//
//
= Installing the Knative Eventing Operator on Red Hat OpenShift Container Platform

Knative Eventing can be installed by using the Knative Eventing Operator available on the Red Hat OpenShift Container Platform web console.

For more information about using the Red Hat OpenShift Container Platform web console, see the link:https://docs.openshift.com/container-platform/4.2/web-console/web-console.html[Red Hat OpenShift Container Platform web console documentation].

IMPORTANT: This release is a developer preview and should not be used in a production environment.

== Prerequisites

* An OpenShift 4 cluster is required for installation. Visit link:https://try.openshift.com[try.openshift.com] for information on setting up an OpenShift 4 cluster.

IMPORTANT: You will need cluster administrator privileges to install and use Knative on an OpenShift cluster.

NOTE: Long-running clusters are not supported in this release.

During installation, the user must determine the following initial settings for the Operator:

* Installation Mode
* Update Channel
* Approval strategy

=== Installation Mode

* Choose **All namespaces on the cluster (default)** to have the Operator installed on all namespaces. You can also choose **A specific namespace on the cluster**, if available, to install the operator in a selected namespace.

=== Update Channel

* If an Operator is available through multiple channels, you can choose the channel to where it is subscribed. For example, to deploy from the `example` channel, select it from the list drop-down list.

=== Approval Strategy

* You can choose **Automatic** or **Manual** updates. If you choose **Automatic** updates for an installed Operator, when a new version of that Operator is available, the OLM automatically upgrades the running instance of your Operator.

* If you select **Manual** updates, when a newer version of an Operator is available, the OLM creates an update request. As a cluster administrator, you must then manually approve that update request to have the Operator updated to the new version.

IMPORTANT: With Knative 0.10.0, sources are now using the Destination API, and references to a `sink` should be written as described below. The previous API has been deprecated and will be removed in future releases.

[source,yaml]
----
...
  sink:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: service-one
----

== Installing the Knative Eventing Operator

. Go to **Catalog > OperatorHub** in the OpenShift Container Platform web console. A list of operators for OpenShift, provided by Red Hat as well as a community of partners and open-source projects is provided. Click on the **Knative Eventing Operator** tile.
+
NOTE: Use the **Filter by Keyword** box to facilitate the search of the Knative Eventing operator in the catalog.
+
image::knative-eventing-tile-highlighted.png[]
+
. A `Show Community Operator` dialog box will appear. Click **Continue** to proceed.

. The **Knative Eventing Operator** descriptor screen will appear. Click **Install**.
+
image::knative-eventing-operator-screen.png[]
+
. On the **Create the Operator Subscription** screen, ensure  **All namespaces on the cluster (default)** is selected under the **Installation Mode** section.
+
image::knative-eventing-namespaces-default.png[]
+
NOTE: The Operator Lifecycle Manager (OLM) will install the operator in all namespaces. The installation will create the `knative-eventing` namespace.
+
. Confirm the subscription for the installation operator, by viewing the **Subscription Overview**. The **UPGRADE STATUS** will update from `O Installing` to `1 Installed`.
+
image::knative-eventing-installed-sub.png[]
+
NOTE: The screen will update after a few minutes. Wait for the `knative-eventing` namespace to appear in the project drop-down menu. Refresh the page if needed.
+
. Knative Eventing is now installed. Navigate to **Catalog > Installed Operators** to confirm the operator is installed. Click on `knative-eventing` to view the install status.
+
image::knative-eventing-installed-operator.png[]

== Uninstalling the Knative Eventing Operator

. Go to **Catalog > OperatorHub** in the OpenShift Web Console.

. Click on the **Knative Eventing Operator** tile.
+
image::knative-eventing-uninstall-tile.png[]
+
NOTE: The tile will indicate whether the operator is installed.
+
. The **Show Community Operator**` dialog box will appear. Click **Continue** to proceed.

. Once the **Knative Eventing Operator** descriptor screen appears, click **Uninstall**.
+
image::knative-eventing-uninstall-operator.png[]
+
. Select **Also completely remove the Operator from the selected namespace**, in the **Remove Operator Subscription** dialog box.
+
. Click **Remove**.
